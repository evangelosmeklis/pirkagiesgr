<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PirkagiesGr - Real-time Fire Monitoring</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üî•</text></svg>">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    
    <!-- Google Analytics (conditional loading based on consent) -->
    <script>
        // Google Analytics with consent management
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        
        // Check if user has accepted cookies
        const hasConsentedToAnalytics = localStorage.getItem('analytics_consent') === 'accepted';
        
        if (hasConsentedToAnalytics) {
            // Load Google Analytics
            gtag('config', 'G-ZPTFP0E6Z9', {
                anonymize_ip: true,
                allow_google_signals: false,
                allow_ad_personalization_signals: false
            });
        } else {
            // Disable Google Analytics
            gtag('config', 'G-ZPTFP0E6Z9', {
                send_page_view: false
            });
        }
        
        // Function to enable analytics
        window.enableAnalytics = function() {
            gtag('config', 'G-ZPTFP0E6Z9', {
                anonymize_ip: true,
                allow_google_signals: false,
                allow_ad_personalization_signals: false
            });
            gtag('event', 'page_view');
        };
        
        // Function to disable analytics
        window.disableAnalytics = function() {
            gtag('config', 'G-ZPTFP0E6Z9', {
                send_page_view: false
            });
        };
    </script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZPTFP0E6Z9"></script>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-fire"></i>
                    <h1>PirkagiesGr</h1>
                </div>
                <div class="header-stats">
                    <div class="stat-item">
                        <span class="stat-number" id="active-fires">0</span>
                        <span class="stat-label">Active Fires</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="last-update">--:--</span>
                        <span class="stat-label">Data Fetched</span>
                    </div>
                </div>
                <div class="header-controls">
                    <div class="update-schedule-indicator">
                        <i class="fas fa-sync-alt"></i>
                        <span id="next-update">Data updates every 30 minutes</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Beta Disclaimer -->
        <div class="beta-disclaimer">
            <div class="beta-content">
                <i class="fas fa-exclamation-triangle beta-icon"></i>
                <span class="beta-text">
                    <strong>üöß BETA VERSION</strong> - This site is in active development and may show incorrect or incomplete fire information. Always verify with official sources and local authorities for emergency situations.
                </span>
                <button class="beta-close" id="beta-close" title="Dismiss">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>

        <!-- Navigation Tabs -->
        <nav class="nav-tabs">
            <button class="tab-btn active" data-tab="live">
                <i class="fas fa-map-marked-alt"></i>
                Live Fire Map
            </button>
            <button class="tab-btn" data-tab="historical">
                <i class="fas fa-history"></i>
                Last 7 Days Fires
            </button>
            <button class="tab-btn" data-tab="about">
                <i class="fas fa-info-circle"></i>
                About
            </button>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Live Fire Map Tab -->
            <div class="tab-content active" id="live-tab">
                <!-- Disclaimer Banner -->
                <div class="disclaimer-banner">
                    <div class="disclaimer-content">
                        <i class="fas fa-exclamation-triangle"></i>
                        <span><strong>For informational purposes only.</strong> Fire data provided by NASA FIRMS. In case of emergency, contact local authorities (Greece: 199, EU: 112).</span>
                    </div>
                </div>
                
                <div class="map-container">
                    <div id="map"></div>
                    
                    <!-- Map Controls -->
                    <div class="map-controls">
                        <div class="controls-header">
                            <h3>üî• Fire Controls</h3>
                            <button class="controls-toggle" id="controls-toggle" title="Toggle controls">
                                <i class="fas fa-chevron-up"></i>
                            </button>
                        </div>
                        <div class="controls-content">
                        <div class="control-group">
                            <label>üéØ Detection Confidence:</label>
                            <select id="confidence-filter" title="Filter by detection confidence level">
                                <option value="all">All Detections</option>
                                <option value="high">üî•üü† Good Detections (‚â•50%)</option>
                                <option value="low">‚ö†Ô∏è Low Confidence (<50%)</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>‚è±Ô∏è Time Period:</label>
                            <select id="time-filter" title="Select time period">
                                <option value="0.04">Last Hour</option>
                                <option value="1" selected>Last 24 hours</option>
                                <option value="3">Last 3 days</option>
                                <option value="7">Last week</option>
                            </select>
                        </div>
                        <div class="data-source-info">
                            <div class="source-badge">
                                üõ∞Ô∏è MODIS & VIIRS Real-time Data
                            </div>
                            <p class="source-description">Combined satellite thermal detection from NASA Terra, Aqua & Suomi NPP satellites. Different emojis distinguish data sources and confidence levels.</p>
                        </div>
                        </div>
                    </div>

                    <!-- Fire Info Panel -->
                    <div class="fire-info-panel" id="fire-info-panel">
                        <div class="panel-header">
                            <h3>Fire Information</h3>
                            <button class="close-btn" id="close-panel" title="Close panel">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="panel-content" id="panel-content">
                            <p>Click on a fire marker to see details</p>
                        </div>
                    </div>

                    <!-- Legend -->
                    <div class="map-legend">
                        <h4>Fire Detection Legend</h4>
                        <div class="legend-section">
                            <div class="legend-item">
                                <div class="legend-marker">üî•</div>
                                <span>MODIS Fire Detection (‚â•50% confidence)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-marker">üü†</div>
                                <span>VIIRS Thermal Detection (‚â•50% confidence)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-marker">‚ö†Ô∏è</div>
                                <span>Low Confidence Detection (<50%)</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Historical Fires Tab -->
            <div class="tab-content" id="historical-tab">
                <div class="historical-container">
                    <div class="historical-header">
                        <h2>Historical Fire Data</h2>
                        <p class="historical-disclaimer">üìÖ Historical data shows the last 7 days of fire detections from NASA MODIS satellites.</p>
                        <div class="historical-controls">
                            <input type="date" id="start-date" class="date-input" title="Start date">
                            <input type="date" id="end-date" class="date-input" title="End date">
                            <button class="btn btn-primary" id="filter-historical">Filter</button>
                        </div>
                    </div>
                    <div class="historical-stats">
                        <div class="stat-card">
                            <i class="fas fa-fire"></i>
                            <div class="stat-info">
                                <span class="stat-value" id="total-historical">0</span>
                                <span class="stat-title">Total Fires</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <i class="fas fa-calendar-day"></i>
                            <div class="stat-info">
                                <span class="stat-value" id="avg-daily">0</span>
                                <span class="stat-title">Avg Daily</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <i class="fas fa-thermometer-three-quarters"></i>
                            <div class="stat-info">
                                <span class="stat-value" id="avg-intensity">0</span>
                                <span class="stat-title">Avg Intensity</span>
                            </div>
                        </div>
                    </div>
                    <div class="historical-table-container">
                        <table class="historical-table" id="historical-table">
                            <thead>
                                <tr>
                                    <th>Detection Time (Greece)</th>
                                    <th>Location</th>
                                    <th>Confidence</th>
                                    <th>Brightness</th>
                                    <th>FRP</th>
                                    <th>Satellite</th>
                                </tr>
                            </thead>
                            <tbody id="historical-tbody">
                                <!-- Historical data will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>



            <!-- About Tab -->
            <div class="tab-content" id="about-tab">
                <div class="about-container">
                    <div class="about-content">
                        <h1>üî• PirkagiesGr</h1>
                        <p class="about-subtitle">Real-time wildfire monitoring for Greece using NASA satellite data</p>
                        
                        <div class="about-section beta-warning">
                            <h2>üöß Beta Version Notice</h2>
                            <div class="disclaimer-card beta-card">
                                <p><strong>This application is currently in BETA testing phase.</strong></p>
                                <ul>
                                    <li>Features may not work as expected or may be incomplete</li>
                                    <li>Fire data accuracy is still being validated and improved</li>
                                    <li>Website functionality is subject to frequent changes</li>
                                    <li>Report any issues or bugs you encounter for improvement</li>
                                </ul>
                                <p class="beta-note">
                                    <i class="fas fa-info-circle"></i>
                                    <strong>Use at your own discretion.</strong> Always verify fire information with official sources and local authorities.
                                </p>
                            </div>
                        </div>
                        
                        <div class="about-section">
                            <h2>‚ö†Ô∏è Important Disclaimer</h2>
                            <div class="disclaimer-card">
                                <p><strong>This application is for informational purposes only.</strong></p>
                                <ul>
                                    <li>Fire detection data may have delays or inaccuracies</li>
                                    <li>Small fires may not be detected by satellites</li>
                                    <li>Weather conditions can affect detection accuracy</li>
                                    <li>Always follow official evacuation orders and safety guidelines</li>
                                </ul>
                                <div class="emergency-numbers">
                                    <h3>üö® Emergency Contacts</h3>
                                    <p><strong>Greece Fire Service:</strong> 199</p>
                                    <p><strong>European Emergency:</strong> 112</p>
                                </div>
                            </div>
                        </div>

                        <div class="about-section">
                            <h2>üõ∞Ô∏è Data Sources & Attribution</h2>
                            <div class="attribution-card">
                                <div class="source-item">
                                    <h3>NASA FIRMS</h3>
                                    <p>Fire detection data provided by NASA's Fire Information for Resource Management System (FIRMS)</p>
                                    <a href="https://firms.modaps.eosdis.nasa.gov/" target="_blank" rel="noopener">Visit NASA FIRMS</a>
                                </div>
                                
                                <div class="source-item">
                                    <h3>Satellite Data</h3>
                                    <p>MODIS and VIIRS instruments on Terra, Aqua, NOAA-20, and NOAA-21 satellites</p>
                                </div>
                                
                                <div class="source-item">
                                    <h3>Weather Data</h3>
                                    <p>Weather information provided by OpenWeatherMap API</p>
                                    <a href="https://openweathermap.org/" target="_blank" rel="noopener">OpenWeatherMap</a>
                                </div>

                                <div class="source-item">
                                    <h3>Satellite Imagery</h3>
                                    <p>Satellite base map provided by Esri</p>
                                </div>
                            </div>
                        </div>

                        <div class="about-section">
                            <h2>üìä Fire Detection Technology</h2>
                            <div class="tech-card">
                                <h3>Confidence Levels</h3>
                                <div class="confidence-levels">
                                    <div class="confidence-item">
                                        <span class="emoji">üî•</span>
                                        <div>
                                            <strong>High (80-100%)</strong>
                                            <p>Confirmed active fires with strong thermal signatures</p>
                                        </div>
                                    </div>
                                    <div class="confidence-item">
                                        <span class="emoji">üü†</span>
                                        <div>
                                            <strong>Medium (50-79%)</strong>
                                            <p>Likely fires that may require ground verification</p>
                                        </div>
                                    </div>
                                    <div class="confidence-item">
                                        <span class="emoji">üü°</span>
                                        <div>
                                            <strong>Low (0-49%)</strong>
                                            <p>Possible fires, could be other heat sources</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="about-section">
                            <h2>üîÑ Automatic Data Updates</h2>
                            <div class="update-info">
                                <p><strong>How it works:</strong> This website automatically updates fire data every 30 minutes using GitHub Actions.</p>
                                <ul>
                                    <li><strong>GitHub Action runs every 30 minutes</strong> to fetch fresh fire data from NASA FIRMS</li>
                                    <li><strong>New data is automatically processed</strong> and saved as JSON files</li>
                                    <li><strong>Website updates instantly</strong> when you refresh the page or visit it</li>
                                    <li><strong>No manual intervention required</strong> - everything happens automatically</li>
                                </ul>
                                <p class="update-note">
                                    <i class="fas fa-info-circle"></i>
                                    You don't need to manually refresh the page. Simply reload the website to get the latest fire data that was fetched by our automated system.
                                </p>
                            </div>
                        </div>

                        <div class="about-section">
                            <h2>üîß Technical Information</h2>
                            <div class="tech-details">
                                <p><strong>NASA Data Update Frequency:</strong> Every 3-6 hours (depending on satellite overpass)</p>
                                <p><strong>Our Fetch Frequency:</strong> Every 30 minutes via GitHub Actions</p>
                                <p><strong>Detection Resolution:</strong> 375m - 1km depending on sensor</p>
                                <p><strong>Geographic Coverage:</strong> Greece (Hellenic Republic)</p>
                                <p><strong>Data Storage:</strong> Static JSON files updated automatically</p>
                            </div>
                        </div>

                        <div class="about-section">
                            <h2>üìÑ Legal</h2>
                            <div class="legal-text">
                                <p>This application is provided "as is" without warranty of any kind. The developers are not responsible for any decisions made based on the information provided.</p>
                                <p>Fire data courtesy of NASA FIRMS. Weather data courtesy of OpenWeatherMap. Satellite imagery courtesy of Esri.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Loading Overlay -->
        <div class="loading-overlay" id="loading-overlay">
            <div class="loading-spinner">
                <i class="fas fa-fire"></i>
                <p>Loading fire data...</p>
            </div>
        </div>

        <!-- Cookie Consent Banner -->
        <div class="cookie-consent-banner" id="cookie-consent-banner">
            <div class="cookie-content">
                <div class="cookie-text">
                    <h3>üç™ Cookie Consent</h3>
                    <p>We use Google Analytics to understand how visitors interact with our website. This helps us improve the user experience. You can choose to accept or reject analytics cookies.</p>
                </div>
                <div class="cookie-buttons">
                    <button class="btn btn-reject" id="reject-cookies">Reject</button>
                    <button class="btn btn-accept" id="accept-cookies">Accept</button>
                </div>
            </div>
        </div>


    </div>

    <!-- Scripts -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="js/api-service.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
